---
import { getCollection } from "astro:content";
import Layout from "../../layouts/Layout.astro";
import PostCard from "../../components/PostCard.astro";

// 1. Fetch and Sort posts
const posts = (await getCollection("blog")).sort((a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf());
---

<Layout title="Blog | Minimalist">
    <section class="mb-16 pt-8">
        <h1 class="text-4xl font-bold tracking-tight text-brand-dark mb-4">Writing</h1>
        <p class="text-lg text-text-muted leading-relaxed max-w-xl">A collection of thoughts, tutorials, and notes.</p>
    </section>

    <section>
        <div class="flex items-baseline justify-between mb-8 border-b border-slate-200 pb-2">
            <h2 class="text-xs font-bold uppercase tracking-wider text-slate-400">All Posts</h2>
            <span class="text-xs text-slate-400">
                {posts.length} posts
            </span>
        </div>

        <div class="space-y-2">
            {
                posts.map((post) => (
                    <PostCard title={post.data.title} date={post.data.pubDate.toISOString().slice(0, 10)} desc={post.data.description} tags={post.data.tags || []} url={`/blog/${post.id}`} />
                ))
            }
        </div>
    </section>
</Layout>
